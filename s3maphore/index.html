<!DOCTYPE html>
<html lang="en">

<head>
    <title>S3ctor&#x27;s S3cret St4sh</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/style.css">
    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/color/pink.css">

        <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/color/background_dark.css">
    
    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/font-hack-subset.css">

    <meta name="description" content="Modern music management for OpenMW, inspired by MUSE and Dynamic Music.">

    <meta property="og:description" content="Modern music management for OpenMW, inspired by MUSE and Dynamic Music.">
    <meta property="og:title" content="S3ctor's S3cret St4sh">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="Modern music management for OpenMW, inspired by MUSE and Dynamic Music.">
    <meta name="twitter:title" content="S3ctor's S3cret St4sh">
    <meta property="twitter:domain" content="DreamWeave-MP.github.io&#x2F;S3ctors-S3cret-St4sh">
    <meta property="twitter:url" content="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/">

                <link rel="alternate" type="application/rss+xml" title="S3ctor&#x27;s S3cret St4sh RSS Feed" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/rss.xml" />
                <link rel="alternate" type="application/atom+xml" title="S3ctor&#x27;s S3cret St4sh Atom Feed" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/atom.xml" />
        <link rel="shortcut icon" type="image/png" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/img/s3_favicon.png">
    
    
    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/fonts.css">
    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/custom.css">
    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/mods.css">
    <link rel="stylesheet" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/search.css">
    
</head>

<body class="">
<div class="container">
    
<header class="header">
    <div class="header__inner">
        <div class="header__logo">
                
            <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh" style="text-decoration: none;">
                <div class="logo">
                    
                        S3ctor&#x27;s S3cret St4sh
                    
                </div>
            </a>
        </div><div class="search-container">
            <input type="text" id="search" placeholder="Search mod pages . . .">
            <div class="search-results">
                <div class="search-results__header"></div>
                <div class="search-results__items"></div>
            </div>
        </div></div>

    
    
    
</header>


    <div class="content">
        
    <div class="post">
        <h1 class="post-title "><a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/">S3maphore</a></h1>
    <div class="post-meta-inline">
    <span class="post-date">
            2025-06-06
        </span>
</div>
        <span class="post-tags-inline">
                :: tags:&nbsp;
                <a class="post-tag" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/tags/frameworks/">#Frameworks</a>&nbsp;
                <a class="post-tag" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/tags/music/">#Music</a>&nbsp;
                <a class="post-tag" href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/tags/openmw-lua/">#OpenMW-Lua</a></span>
    
        

<modData id="mod-data" name="S3maphore" path="&#x2F;s3maphore&#x2F;" project="S3ctors-S3cret-St4sh"
owner="DreamWeave-MP" data_directories="[&quot;# Required&quot;,&quot;00 Core&quot;,&quot;# Recommended&quot;,&quot;01 Tamriel Rebuilt Playlists&quot;,&quot;02 Project Cyrodiil Playlists&quot;,&quot;03 Muse Expansion Playlists&quot;,&quot;06 Songbook of the North&quot;,&quot;10 Inns and Taverns&quot;,&quot;# Starwind only!&quot;,&quot;07 Starwind Playlists&quot;]"
fallback_entries="[]"                                  
content_files="[&quot;S3maphore.esp&quot;]"
config="[]"
></modData>

<div class="mod-download-info">
    <h5>Version: 0.62</h5>
    <div class="custom-divider"></div>
    <div id="download-button-stack" class="button-stack">
    <div style="display:flex;">
        <a id="stable-download-button" class="dw-download-button rounded outline underlined_link" href="




https:&#x2F;&#x2F;github.com&#x2F;DreamWeave-MP&#x2F;S3ctors-S3cret-St4sh&#x2F;releases&#x2F;download&#x2F;s3maphore-0.62/s3maphore.zip" title="Get the latest stable release of S3maphore">Stable</a>
        <a class="dw-download-button rounded outline underlined_link" href="



https:&#x2F;&#x2F;github.com&#x2F;DreamWeave-MP&#x2F;S3ctors-S3cret-St4sh&#x2F;releases&#x2F;download&#x2F;development/s3maphore.zip" title="Development builds might be more featureful, but could be untested.">Dev</a>
    </div>
    <!-- This could be spicy -->
    <!-- we don't properly url-encode the download links here -->
    <!-- but I'm not aware that github url-encodes release assets or how to check, so instead we shall YOLO it -->
    <a class="dw-download-button rounded outline underlined_link" href="modl://morrowind/?url=




https:&#x2F;&#x2F;github.com&#x2F;DreamWeave-MP&#x2F;S3ctors-S3cret-St4sh&#x2F;releases&#x2F;download&#x2F;s3maphore-0.62/S3maphore.zip" title="Download with ModdingLinked MO2 or umo using modl://">umo/mo2
    </a>
</div>

    <div class="custom-divider"></div><div id="misc-button-stack" class="button-stack">
    
    <a class="dw-download-button rounded outline underlined_link" href="https://nexusmods.com/morrowind/mods/56836/description" title="Check out S3maphore on NexusMods.">NexusMods</a>
    
    <a class="dw-download-button rounded outline underlined_link" href="https:&#x2F;&#x2F;DreamWeave-MP.github.io&#x2F;S3ctors-S3cret-St4sh&#x2F;s3maphore&#x2F;changelog" title="See the changelog for S3maphore.">Changelog</a>
</div>
<div class="custom-divider"></div><div id="git-button-stack" class="button-stack">
    <a class="dw-download-button rounded outline underlined_link" href="

https:&#x2F;&#x2F;github.com&#x2F;DreamWeave-MP&#x2F;S3ctors-S3cret-St4sh/commits/main" title="See activity and recent work on S3maphore on GitHub.">Activity</a>
    <a class="dw-download-button rounded outline underlined_link" href="

https:&#x2F;&#x2F;github.com&#x2F;DreamWeave-MP&#x2F;S3ctors-S3cret-St4sh/issues/new" title="Report an issue with S3maphore on GitHub.">Report a Problem</a>
</div>
</div>


    <ul id="toc-main">
    
        <li>
            <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#compatibility-with-other-music-mods">Compatibility With Other Music Mods</a>
            
        </li>
    
        <li>
            <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#usage">Usage</a>
            
                <ul>
                    
                        <li>
                            <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#s3maphore-for-modders">S3maphore for Modders</a>
                            
                            <ul>
                              
                              <li>
                                <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#playlist-creation">Playlist Creation</a>
                              </li>
                              
                              <li>
                                <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#the-special-playlist">The Special Playlist</a>
                              </li>
                              
                              <li>
                                <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#playlist-localization">Playlist Localization</a>
                              </li>
                              
                              <li>
                                <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#events">Events</a>
                              </li>
                              
                              <li>
                                <a href="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/s3maphore/#settings">Settings</a>
                              </li>
                              
                            </ul>
                            
                        </li>
                    
                </ul>
            
        </li>
    
    </ul>

<div class="post-content">
            <div align="center">
  <figure>
    <img src="../img/S3maphoreBanner.png" alt="semaphore icon" width="512" height="608" />
    <figcaption><h2 class="notoc">Brought to You by the Love and Passion of Modding-OpenMW.com</h2></figcaption>
  </figure>
  <br>
  <br>
</div>
<p>Your music, just the way you want it. No compromises, no bullshit, with a focus on scalability and extreme attention to performance optimization.</p>
<p>I simply decided existing music solutions were not good enough after OpenMW's music system was dehardcoded. The underlying playlist mechanism used by OpenMW is very powerful - but due to a disagreement about playlist conflict resolution, the public API for music playlists was removed. Since that time, version 0.49 has straightforwardly not been living up to its true potential.</p>
<p>S3maphore fixes that. Why call it S3maphore?</p>
<p>In computing, a semaphore is a synchronization primitive designed to allow concurrent access to systems which may really only have one consumer at a time. This definition and application both date back to mid-nineteenth century, when the semaphore was first developed as a safety measure for signalling train drivers on railways.</p>
<p>This one is no different - S3maphore is a full replacement for OpenMW's builtin music handling that can be configured or permutated in any way you can imagine.</p>
<p>If you imagine one that it doesn't offer, let's fix that together.</p>
<p>S3maphore works through a system of playlists, similarly to Dynamic Music or MUSE. However, unlike both, S3maphore is an open-ended system, which allows playlist creators to define <em>any</em> conditions under which a playlist should run. For more details, view the <a href="#playlist-creation">Playlist Creation</a> section.</p>
<p>If you just want to install the mod, stop here. For Lua scripters or playlist developers, view the table of contents for more details.</p>

<ul>
  <li>Download the mod from <a href="https:&#x2F;&#x2F;DreamWeave-MP.github.io&#x2F;S3ctors-S3cret-St4sh&#x2F;s3maphore&#x2F;#stable-download-button">Here</a></li>
  <li>Extract the zip to a location of your choosing.</li>
  <li>Paste the location you extracted it to into the form below, hit <code>Generate Config</code>, and paste the result into openmw.cfg.</li>
</ul>
<div id="install-info-outer">
  <p>Where would you like to install this mod?</p>
  <div id="install-info-inner">
    <input id="install-path-input" placeholder="C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore" type="text">
    <div id="install-path-buttons">
      <button id="generate-config-button" style="dw-download-button rounded outline underlined_link" onclick="generateConfig()">Generate Config</button>
      <button id="copy-config-button" style="dw-download-button rounded outline underlined_link" onclick="copyConfigToClipboard()">Copy Config to Clipboard</button>
    </div>
  </div>
  <pre id="config-code-pre"><code id="config-code" data-lang="cfg" class="language-cfg">

# S3maphore Data Directories
# Required
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/00 Core
# Recommended
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/01 Tamriel Rebuilt Playlists
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/02 Project Cyrodiil Playlists
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/03 Muse Expansion Playlists
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/06 Songbook of the North
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/10 Inns and Taverns
# Starwind only!
data=C:&#x2F;Games&#x2F;OpenMW-Mods/S3maphore/07 Starwind Playlists

# S3maphore Content Files
content=S3maphore.esp



  </code></pre>
</div>
<h3 id="compatibility-with-other-music-mods">Compatibility With Other Music Mods</h3>
<p>Dynamic Music and MUSE soundbanks are not natively supported. However, you can convert either to a S3maphore playlist in minutes by using this document.
Any mods which simply add to or replace music Morrowind already provides (EG, in the <code>Explore</code>, <code>Special</code>, or <code>Battle</code> folders) are natively compatible with zero extra work.</p>
<p>S3maphore ships a set of BAIN modules with Playlist Arrays which can be used in conjunction with tracks provided by other mods. Where appropriate, these modules are folder-based and will allow you to extend them yourself.</p>
<ul>
<li><a rel="external" href="https://www.nexusmods.com/morrowind/mods/47254">01 Tamriel Rebuilt Playlists</a></li>
<li><a rel="external" href="https://www.nexusmods.com/morrowind/mods/55779">02 Project Cyrodiil Playlists</a></li>
</ul>
<h2 id="usage">Usage</h2>
<p>Make sure to install the playlist files <em>and</em> tracks for any S3maphore playlist arrays you install. In the settings menu, you can toggle S3maphore debug messages and the onscreen track/playlist name display.</p>
<p>All S3maphore playlists may ship a unique l10n context with the appropriate playlist/name strings for your preferred language. Presently, only English is supported, but translations are greatly welcomed!</p>
<p>Also in the settings menu, you can scroll through registered playlists and manually enable/disable them completely.</p>
<p>TIP: If you can't toggle a playlist on or off, that means S3maphore couldn't find any of the tracks this playlist has registered in your game.</p>
<p>Finally, pressing F8 will always skip the current track if one is playing - if the shift key is held when pressing F8, it will toggle music playback on or off entirely.</p>
<h3 id="s3maphore-for-modders">S3maphore for Modders</h3>
<p>As mentioned before, S3maphore is an open-ended system for playlist management. It is so open-ended, in fact, that you do not need to use S3maphore's built-in playlist management at all. Other playlist-related mods or plugins could easily be built on top of S3maphore's internal interface and provided events. This section of the docs will describe how to make your own playlists and interact with S3maphore's public methods and mechanisms.</p>
<h4 id="playlist-creation">Playlist Creation</h4>
<p>S3maphore's playlists are <em>similar</em>, but not identical, to existing solutions. There are some key differences, however:</p>
<h5 id="playlist-specification">Playlist Specification</h5>
<ol>
<li>S3maphore playlist files are known as <code>Playlist Arrays</code>, because that's what they are. Every playlist file can return any number of playlists inside of table it sends back out. Every playlist must have both a string <code>id</code> and a <code>priority</code> field. <code>id</code> is the name of the playlist which is used as a table key, and <code>priority</code> is a number between 1 and 1000 indicating when the playlist should override others or be overridden by others. More on playlist priority below. Optional fields include:
<ol>
<li><code>tracks</code> - <code>string[]</code> - List of VFS paths to tracks to play. If using MUSE or Dynamic Music soundbanks as a base, the paths can be copied directly.</li>
<li><code>active</code> - <code>boolean</code> - If false, this playlist will never be selected for playback. Defaults to true. See below for how to turn it on, if it's not actually enabled.</li>
<li><code>randomize</code> - <code>boolean</code> - Whether to play tracks from this playlist in the actual written order or randomly. Defaults to false.</li>
<li><code>cycleTracks</code> - <code>boolean</code> - Whether to continue repeating the playlist after it has finished. Defaults to true.</li>
<li><code>playOneTrack</code> - <code>boolean</code> - If true, the playlist will only play a single track and then deactivate itself. It must be reactivated using either the <code>setPlaylistActive</code> event or interface function in <code>I.S3maphore</code>. Defaults to false.</li>
<li><code>isValidCallback</code> - <code>function(playback: Playback): boolean</code> - A function which returns true/false to indicate whether or not a given playlist should run in this specific context. Only optional when using <code>PlaylistPriority.Never</code></li>
<li><code>fadeOut</code> - <code>number</code> - optional duration for the fadeOut time between tracks in a playlist.</li>
<li><code>silenceBetweenTracks</code> - <code>PlaylistSilenceParams</code> - Parameters for determining how long, if at all, fake silence tracks are used in a playlist. See below for a more detailed description of the <code>PlaylistSilenceParams</code> type.</li>
<li><code>interruptMode</code> - <code>InterruptMode</code> - This field determines whether or not a playlist may be interrupted by another, based on the archetypes used by vanilla playlists. Valid values are <code>INTERRUPT.Me</code>, <code>INTERRUPT.Other</code>, and <code>INTERRUPT.Never</code>.</li>
<li><code>fallback</code> - <code>PlaylistFallback</code> - Selection of fallback tracks and playlists which can be used alongside this playlist. See below for details of the <code>PlaylistFallback</code> type.</li>
<li><code>exclusions</code> - <code>S3maphorePlaylistExclusions</code> - Selection of tracks and sub-directories which will NOT be played by this particular list</li>
</ol>
</li>
<li>S3maphore replaces OpenMW's builtin music script almost in its entirety. This means that conflicts between the two are mostly-impossible and limitations such as needing to manually set/know the duration of specific tracks is no longer necessary.</li>
<li>S3maphore playlists do <em>not</em> have strictly defined rules, instead relying on the <code>isValidCallback</code> to allow each playlist to define its own rules in a very open-ended way. Every <code>isValidCallback</code> is passed a <code>playback</code> struct, which is a table containing two more tables: <code>state</code>, and <code>rules</code>.</li>
</ol>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> PlaylistSilenceParams</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> min</span><span style="color: #97E1F1;font-style: italic;"> integer minimum possible duration for this silence track</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> max</span><span style="color: #97E1F1;font-style: italic;"> integer maximum possible duration for this silence track</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> chance</span><span style="color: #97E1F1;font-style: italic;"> number probablility that this playlist will use silence between tracks</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example of how silenceparams may be used in a playlist</span></span>
<span class="giallo-l"><span>silenceBetweenTracks</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span>    chance</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> 0.1</span><span>,</span></span>
<span class="giallo-l"><span>    max</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> 30</span><span>,</span></span>
<span class="giallo-l"><span>    min</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> 10</span><span>,</span></span>
<span class="giallo-l"><span>},</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Data type used to bridge one playlist into another, or to extend</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> PlaylistFallback</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> playlistChance</span><span style="color: #97E1F1;font-style: italic;"> number</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">optional float between 1 and 0 indicating the chance for a fallback playlist to be selected. If not present</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">the chance is always 50</span><span style="color: #7B7F8B;">%</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> playlists</span><span style="color: #97E1F1;font-style: italic;"> string[]</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">array of fallback playlists from which to select tracks. No default values and not required.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> tracks</span><span style="color: #97E1F1;font-style: italic;"> string[]</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">tracks to manually add to a given playlist. Used for folder-based playlists</span><span style="color: #7B7F8B;">;</span><span style="color: #97E1F1;font-style: italic;"> not necessary for any others</span></span>
<span class="giallo-l"><span>fallback</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span>    playlistChance</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> 0.25</span><span>,</span></span>
<span class="giallo-l"><span>    playlists</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span style="color: #DEE492;">        &#39;</span><span style="color: #E7EE98;">Explore</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span style="color: #DEE492;">        &#39;</span><span style="color: #E7EE98;">Tamriel Rebuilt - Port Telvannis</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>    tracks</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span style="color: #DEE492;">        &#39;</span><span style="color: #E7EE98;">explore/mx_explore_1.mp3</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Special class for handling exterior grids.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Used for special circumstances in which playlists should only run in *particular* exterior cells</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> S3maphoreCellGrid</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> x</span><span style="color: #97E1F1;font-style: italic;"> integer</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> y</span><span style="color: #97E1F1;font-style: italic;"> integer</span></span>
<span class="giallo-l"><span>grid</span><span style="color: #F286C4;"> =</span><span> { x</span><span style="color: #F286C4;"> = -</span><span style="color: #BF9EEE;">2</span><span>, y</span><span style="color: #F286C4;"> = -</span><span style="color: #BF9EEE;">2</span><span>, }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> S3maphorePlaylistExclusions</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> playlists</span><span style="color: #97E1F1;font-style: italic;"> string[]</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">list of subdirectories to ignore when constructing a playlist. the </span><span style="color: #DEE492;">`</span><span style="color: #E7EE98;">music/</span><span style="color: #DEE492;">` </span><span style="color: #97E1F1;font-style: italic;">prefix is inferred</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">so this field works the same way as playlist IDs.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> tracks</span><span style="color: #97E1F1;font-style: italic;"> string[]</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">explicit list of tracks to ignore when constructing a playlist. the </span><span style="color: #DEE492;">`</span><span style="color: #E7EE98;">music/</span><span style="color: #DEE492;">` </span><span style="color: #97E1F1;font-style: italic;">prefix is inferred</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">so this field works the same way as playlist IDs.</span></span>
<span class="giallo-l"><span>exclusions</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span>    tracks</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span style="color: #DEE492;">        &#39;</span><span style="color: #E7EE98;">explore/nerevar_rising.mp3</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>    playlists</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span style="color: #DEE492;">        &#39;</span><span style="color: #E7EE98;">expore/subdir/</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>}</span></span></code></pre><h5 id="playliststate-specification">PlaylistState Specification</h5>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> StaticList</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> recordIds</span><span style="color: #97E1F1;font-style: italic;"> string[] array of all unique static record ids in the current cell</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> contentFiles</span><span style="color: #97E1F1;font-style: italic;"> string[] array of all unique content files which placed statics in this cell</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> PlaylistState</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> self</span><span style="color: #97E1F1;font-style: italic;"> userdata the player actor</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> playlistTimeOfDay</span><span style="color: #97E1F1;font-style: italic;"> TimeMap the time of day for the current playlist</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> isInCombat</span><span style="color: #97E1F1;font-style: italic;"> boolean whether the player is in combat or not</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> cellIsExterior</span><span style="color: #97E1F1;font-style: italic;"> boolean whether the player is in an exterior cell or not </span><span style="color: #7B7F8B;">(</span><span style="color: #97E1F1;font-style: italic;">includes fake exteriors such as starwind</span><span style="color: #7B7F8B;">)</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> cellName</span><span style="color: #97E1F1;font-style: italic;"> string lowercased name of the cell the player is in</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> cellId</span><span style="color: #97E1F1;font-style: italic;"> string engine-level identifier for cells. Should generally not be used in favor of cellNames as the only way to determine cell ids is to check in-engine using </span><span style="color: #DEE492;">`</span><span style="color: #E7EE98;">cell.id</span><span style="color: #DEE492;">`</span><span style="color: #97E1F1;font-style: italic;">. It is made available in PlaylistState mostly for caching purposes</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">but may be used regardless.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> combatTargets</span><span style="color: #97E1F1;font-style: italic;"> FightingActors a read-only table of combat targets</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">where keys are actor IDs and values are booleans indicating if the actor is currently fighting</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> staticList</span><span style="color: #97E1F1;font-style: italic;"> StaticList a list of all recordIds and content files placing objects in this cell. This is used in staticContentFile</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">staticMatch</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">and staticExact rules for playlists.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> weather</span><span style="color: #97E1F1;font-style: italic;"> WeatherType a string indicating the current weather name. Updated by an internal mwscript in 0.49-compatible versions.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> nearestRegion</span><span style="color: #97E1F1;font-style: italic;"> string</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">The current region the player is in. This is determined by either checking the current region of the player</span><span style="color: #DEE492;">&#39;</span><span style="color: #E7EE98;">s current cell, OR, reading all load door</span><span style="color: #DEE492;">&#39;</span><span style="color: #97E1F1;font-style: italic;">s target cell</span><span style="color: #DEE492;">&#39;</span><span style="color: #E7EE98;">s regions in the current cell. The first cell which is found to have a region will match and be assigned to the PlaylistState.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> currentGrid</span><span style="color: #97E1F1;font-style: italic;"> S3maphoreCellGrid</span><span style="color: #F286C4;">? </span><span style="color: #97E1F1;font-style: italic;">The current exterior cell grid. Nil if not in an actual exterior.</span></span></code></pre>
<p>As usual, if there are more state values you'd like the PlaylistState to offer, please do share! A generic-enough use case can and absolutely will make the cut.</p>
<p><code>rules</code> is a table of functions that can have certain data passed into them to define when a S3maphore playlist should run. This is the real meat and potatoes of creating a S3maphorePlaylist. For exmaple:</p>
<p>WARNING:
Take note of the fact that the <code>OuterRimCells</code> table is declared and defined in an upper scope, outside of the <code>isValidCallback</code> function. This is crucial for S3maphore's lookup caching methods to work. <em>Never</em> inline a table constructor in your <code>isValidCallbacks</code>, or you <em>will</em> lose performance for no reason and trigger a memory leak. This is unavoidable on S3maphore's part, so it is <em>paramount</em> that you use it properly. NEVER make an <code>isValidCallback</code> that looks like this:</p>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">    --- Major Dysfuckulation!</span></span>
<span class="giallo-l"><span style="color: #62E884;">    isValidCallback</span><span style="color: #F286C4;"> = function</span><span>(</span><span style="color: #FFB86C;font-style: italic;">playback</span><span>)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">        return</span><span> playback.rules.</span><span style="color: #62E884;">cellNameExact</span><span>{ [</span><span style="color: #DEE492;">&#39;</span><span style="color: #E7EE98;">The Outer Rim</span><span style="color: #DEE492;">&#39;</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #BF9EEE;"> true</span><span>, [</span><span style="color: #DEE492;">&#39;</span><span style="color: #E7EE98;">The Outer Rim, Freighter</span><span style="color: #DEE492;">&#39;</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #BF9EEE;"> true</span><span>, }</span></span>
<span class="giallo-l"><span style="color: #F286C4;">    end</span></span></code></pre><pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">--- Extremely stable levels of fuckitude</span></span>
<span class="giallo-l"><span style="color: #F286C4;">local</span><span> OuterRimCells</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span>    [</span><span style="color: #DEE492;">&#39;</span><span style="color: #E7EE98;">the outer rim</span><span style="color: #DEE492;">&#39;</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #BF9EEE;"> true</span><span>,</span></span>
<span class="giallo-l"><span>    [</span><span style="color: #DEE492;">&#39;</span><span style="color: #E7EE98;">the outer rim, freighter</span><span style="color: #DEE492;">&#39;</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #BF9EEE;"> true</span><span>,</span></span>
<span class="giallo-l"><span>}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #F286C4;">local</span><span> PlaylistPriority</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> require</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">doc.playlistPriority</span><span style="color: #DEE492;">&#39;</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@type</span><span style="color: #97E1F1;font-style: italic;"> S3maphorePlaylist[]</span></span>
<span class="giallo-l"><span style="color: #F286C4;">return</span><span> {</span></span>
<span class="giallo-l"><span>    {</span></span>
<span class="giallo-l"><span>        id</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">Rickoff/The Outer Rim</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>        priority</span><span style="color: #F286C4;"> =</span><span> PlaylistPriority.CellExact,</span></span>
<span class="giallo-l"><span>        randomize</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> true</span><span>,</span></span>
<span class="giallo-l"><span style="color: #62E884;">        isValidCallback</span><span style="color: #F286C4;"> = function</span><span>(</span><span style="color: #FFB86C;font-style: italic;">playback</span><span>)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">            return</span><span> playback.rules.</span><span style="color: #62E884;">cellNameExact</span><span>(OuterRimCells)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">        end</span><span>,</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>    {</span></span>
<span class="giallo-l"><span>        id</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">Rickoff/Club Arkngthand</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>        priority</span><span style="color: #F286C4;"> =</span><span> PlaylistPriority.CellExact,</span></span>
<span class="giallo-l"><span>        randomize</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> true</span><span>,</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #62E884;">        isValidCallback</span><span style="color: #F286C4;"> = function</span><span>(</span><span style="color: #FFB86C;font-style: italic;">playback</span><span>)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">            return</span><span> playback.state.self.cell.id</span><span style="color: #F286C4;"> ==</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">nar shaddaa, club arkngthand</span><span style="color: #DEE492;">&#39;</span></span>
<span class="giallo-l"><span style="color: #F286C4;">        end</span><span>,</span></span>
<span class="giallo-l"><span>    }</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>TIP: If you don't want to specify track names manually, just don't! If no tracks are listed for a playlist, its <code>id</code> field is used to determine a folder name in which a playlist's tracks will be looked for. See the builtin playlists for an easy example:</p>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span>{</span></span>
<span class="giallo-l"><span>    id</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &quot;</span><span style="color: #E7EE98;">Explore</span><span style="color: #DEE492;">&quot;</span><span>,</span></span>
<span class="giallo-l"><span>    priority</span><span style="color: #F286C4;"> =</span><span> PlaylistPriority.Explore,</span></span>
<span class="giallo-l"><span>    randomize</span><span style="color: #F286C4;"> =</span><span style="color: #BF9EEE;"> true</span><span>,</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #62E884;">    isValidCallback</span><span style="color: #F286C4;"> = function</span><span>()</span></span>
<span class="giallo-l"><span style="color: #F286C4;">        return not</span><span> Playback.state.isInCombat</span><span style="color: #F286C4;"> and</span><span> defaultPlaylistStates.ExploreActive</span></span>
<span class="giallo-l"><span style="color: #F286C4;">    end</span><span>,</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>Above is S3maphore's version of Morrowind's built-in <code>Explore</code> playlist. No tracks are listed, because it just randomly picks from <code>Music/Explore</code>, since <code>Explore</code> is the playlist id.</p>
<h5 id="playlistrules-specification">PlaylistRules Specification</h5>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns whether the current cell name matches a pattern rule. Checks disallowed patterns first</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.cellNameMatch { allowed = { &#39;mages&#39;, &#39;south wall&#39;, }, disallowed = { &#39;fighters&#39;, } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> patterns</span><span style="color: #97E1F1;font-style: italic;"> CellMatchPatterns</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">cellNameMatch</span><span>(</span><span style="color: #FFB86C;font-style: italic;">patterns</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns whether or not the current cell exists in the cellNames map</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.cellNameExact { &#39;balmora, caius cosades\&#39;s house&#39; = true, &#39;balmora, guild of mages&#39; = true, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> cellNames</span><span style="color: #97E1F1;font-style: italic;"> IDPresenceMap</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">cellNameExact</span><span>(</span><span style="color: #FFB86C;font-style: italic;">cellNames</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns whether the player is currently in combat with any actor out of the input set</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- the playlistState provided to each `isValidCallback` includes a `combatTargets` field which is meant to be used as the first argument</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Exmple usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTarget { &#39;caius cosades&#39; = true, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> validTargets</span><span style="color: #97E1F1;font-style: italic;"> IDPresenceMap</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">combatTargetExact</span><span>(</span><span style="color: #FFB86C;font-style: italic;">validTargets</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Finds any nearby combat target whose name matches any one string of a set</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlist.rules.combatTargetMatch { &#39;jedi&#39;, &#39;sith&#39;, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> validTargetPatterns</span><span style="color: #97E1F1;font-style: italic;"> string[]</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">combatTargetMatch</span><span>(</span><span style="color: #FFB86C;font-style: italic;">validTargetPatterns</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Checks the current cell&#39;s static list for whether</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- an allowed static is present, or a disallowed one is present.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.staticExact { &#39;furn_de_ex_bench_01&#39; = true, &#39;ex_ashl_tent_01&#39; = false, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> staticRules</span><span style="color: #97E1F1;font-style: italic;"> IDPresenceMap</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span><span style="color: #F286C4;">?</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">staticExact</span><span>(</span><span style="color: #FFB86C;font-style: italic;">staticRules</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Checks the current cell&#39;s static list to see if it contains any object matching any of the input patterns</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- WARNING: This is the most expensive possible playlist filter. It is only available in interior cells as S3maphore will not track statics in exterior cells.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.staticMatch { &#39;cave&#39;, &#39;py&#39;, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> patterns</span><span style="color: #97E1F1;font-style: italic;"> string[]</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span><span style="color: #F286C4;">?</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">staticMatch</span><span>(</span><span style="color: #FFB86C;font-style: italic;">patterns</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns whether or not a given cell contains statics matching the given content file array</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Automatically lowercases all input content file names!</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playback.rules.staticContentFile { [&#39;starwind enhanced.esm&#39;] = true, }</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">staticContentFile</span><span>(</span><span style="color: #FFB86C;font-style: italic;">contentFiles</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Checks whether the current gameHour matches a certain time of day or not</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.timeOfDay(8, 12)</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> minHour</span><span style="color: #97E1F1;font-style: italic;"> integer</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> maxHour</span><span style="color: #97E1F1;font-style: italic;"> integer</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">timeOfDay</span><span>(</span><span style="color: #FFB86C;font-style: italic;">minHour</span><span>,</span><span style="color: #FFB86C;font-style: italic;"> maxHour</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Return whether the current region matches a set</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.region { &#39;azura\&#39;s coast region&#39; = true, &#39;sheogorad region&#39; = true, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> regionNames</span><span style="color: #97E1F1;font-style: italic;"> IDPresenceMap</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">region</span><span>(</span><span style="color: #FFB86C;font-style: italic;">regionNames</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Rule for checking whether combat targets match a specific type. This can be for NPCs, or specific subtypes of creatures, such as undead, or daedric.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Valid values are listed under the TargetType enum.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- NOTE: These are hashsets and only `true` is a valid value.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Inputs must always be lowercased. Yes, really.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- </span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example Usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- </span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTargetType { [&#39;npc&#39;] = true }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTargetType { [&#39;undead&#39;] = true }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> targetTypeRules</span><span style="color: #97E1F1;font-style: italic;"> CombatTargetTypeMatches</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">combatTargetType</span><span>(</span><span style="color: #FFB86C;font-style: italic;">targetTypeRules</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Rule for checking if the player is fighting vampires of any type, or clan.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- To check specific vampire clans, use the faction rule.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">fightingVampires</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Sets a relative or absolute limit on combat target levels for triggering combat music.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- levelDifference rules may be relative or absolute, eg a multplier of the player&#39;s level or the actual difference in level.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- They may have a minimum and maximum threshold, although either is optional.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Negative values indicate the player is stronger, whereas positive ones indicate the target is stronger.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- This rule plays if the target&#39;s level is equal to or up to five levels bove the player&#39;s</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTargetLevelDifference { absolute = { min = 0, max = 5 } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- This rule is valid if the target&#39;s level is within half or twice the player&#39;s level. EG if you&#39;re level 20, and the target is level 10, this rule matches.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTargetLevelDifference { relative = { min = 0.5, max = 2.0 } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> levelRule</span><span style="color: #97E1F1;font-style: italic;"> LevelDifferenceMap</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">combatTargetLevelDifference</span><span>(</span><span style="color: #FFB86C;font-style: italic;">levelRule</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Checks whether or not an actor meets a specific threshold for any of the three dynamic stats - health, fatigue, or magicka.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Any combination of the three will work, and one may use a maximum and/or a minimum threshold</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Rule is valid if an actor has MORE than 25% health</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.dynamicStatThreshold { health = { min = 0.25 } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Rule is valid is an actor has LESS THAN 75% magicka.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.dynamicStatThreshold { magicka = { max = 0.75 } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> statThreshold</span><span style="color: #97E1F1;font-style: italic;"> StatThresholdMap decimal number encompassing how much health the target should have left in order for this playlist to be considered valid</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">dynamicStatThreshold</span><span>(</span><span style="color: #FFB86C;font-style: italic;">statThreshold</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Rule for checking the rank of a target in the specified faction.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Like any rule utilizing a LevelDifferenceMap, either min or max are optional, but *one* of the two is required.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTargetFaction { hlaalu = { min = 1 } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> factionRules</span><span style="color: #97E1F1;font-style: italic;"> NumericPresenceMap</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">combatTargetFaction</span><span>(</span><span style="color: #FFB86C;font-style: italic;">factionRules</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Playlist rule for checking a specific journal state</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playback.rules.journal { A1_V_VivecInformants = { min = 50, max = 55, }, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> journalDataMap</span><span style="color: #97E1F1;font-style: italic;"> NumericPresenceMap</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">journal</span><span>(</span><span style="color: #FFB86C;font-style: italic;">journalDataMap</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Checks whether any combat target&#39;s classes matches one of a hashset</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- ALWAYS LOWERCASE YOUR INPUTS!</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- </span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example Usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- </span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.combatTargetClasses { [&#39;guard&#39;] = true, [&#39;acrobat&#39;] = true }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> classes</span><span style="color: #97E1F1;font-style: italic;"> IDPresenceMap</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">combatTargetClass</span><span>(</span><span style="color: #FFB86C;font-style: italic;">classes</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Rule used to check if a nearby merchant does, or doesn&#39;t, offer a specific service.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Works on all nearby actors, and bails and returns true for the first actor whom matches all provided rules.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Works best in locations where a single merchant is present - for cells where multiple actors may potentially offer the same service, like The Abecette,</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- a cellNameMatch or cellNameExact rule may be more appropriate.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Only accepts a limited range of inputs as defined by the `ServicesOffered` type.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example Usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- local services = { [&quot;Armor&quot;] = true, [&#39;Repair&#39;] = true, }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.localMerchantType(services)</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> services</span><span style="color: #97E1F1;font-style: italic;"> ServicesOffered</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">localMerchantType</span><span>(</span><span style="color: #FFB86C;font-style: italic;">services</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns whether the current exterior cell is on a particular node of the grid</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Example usage:</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- playlistRules.exteriorGrid { { x = -2, y = -3 } }</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> gridRules</span><span style="color: #97E1F1;font-style: italic;"> S3maphoreCellGrid[]</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> PlaylistRules</span><span>.</span><span style="color: #62E884;">exteriorGrid</span><span>(</span><span style="color: #FFB86C;font-style: italic;">gridRules</span><span>)</span></span></code></pre>
<p>All of these functions may be chained, used, ignored, or even reimplemented by you, as long as your playlist's <code>isValidCallback</code> returns true when it's supposed to play and false|nil when it isn't.</p>
<p>NOTE:
While S3maphore doesn't <em>require</em> that you use its built-in callbacks, your life will be easier if you do. S3maphore caches as many of its lookups as it possibly can, so one particular cell for example, will only <em>really</em> run the necessary code for these callbacks if it's never happened before.
In practice, this means most of the performance hit from S3maphore occurs during cell transitions. Increased usage will also occur durng combat as a much larger segment of the total number of registered playlist is iterated.</p>
<p>Optimizing your playlists is important!</p>
<p>S3maphore works by calling every <code>isValidCallback</code>, for every playlist which is marked as <code>active</code> and has at least one track, every single frame. This is why the caching is necessary, and why it's important to keep your isValidCallbacks simple where you can.</p>
<p>Use S3maphore's open ended nature to your advantage, but <em>please</em> keep in mind that every playlist is running its callbacks every single frame. You are sharing not-a-lot of space with a lot of neighbors who are very much in a hurry.</p>
<p>If you do run into performance bottlenecks with your playlists, please let me know and I will do everything I can to help make your playlists functional. Later iterations of S3maphore are likely to rely on my helper library, <a rel="external" href="https://modding-openmw.gitlab.io/s3ctors-s3cret-st4sh/h3lp_yours3lf">H3lp Yours3lf</a>, for additional optimizations!</p>
<h5 id="playlist-environment-specification">Playlist Environment Specification</h5>
<p>Starting from version <code>0.54</code> and onward, S3maphore provides a builtin environment to playlists which can be used to simplify the creation of playlists.
For example, a playlist which used to look like this:</p>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #F286C4;">local function</span><span style="color: #62E884;"> crystalCityRule</span><span>(</span><span style="color: #FFB86C;font-style: italic;">playback</span><span>)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">    return</span><span> playback.rules.</span><span style="color: #62E884;">cellNameExact</span><span>(CrystalCityCells)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">end</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #F286C4;">local</span><span> PlaylistPriority</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> require</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">doc.playlistPriority</span><span style="color: #DEE492;">&#39;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@type</span><span style="color: #97E1F1;font-style: italic;"> S3maphorePlaylist[]</span></span>
<span class="giallo-l"><span style="color: #F286C4;">return</span><span> {</span></span>
<span class="giallo-l"><span>    {</span></span>
<span class="giallo-l"><span>        id</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">MOMW Patches - Secrets of the Crystal City</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>        priority</span><span style="color: #F286C4;"> =</span><span> PlaylistPriority.CellExact,</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>        tracks</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span style="color: #DEE492;">            &#39;</span><span style="color: #E7EE98;">music/aa22/tew_aa_3.mp3</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>        },</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>        isValidCallback</span><span style="color: #F286C4;"> =</span><span> crystalCityRule,</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>May now be:</p>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #F286C4;">local function</span><span style="color: #62E884;"> crystalCityRule</span><span>()</span></span>
<span class="giallo-l"><span style="color: #F286C4;">    return</span><span> Playback.rules.</span><span style="color: #62E884;">cellNameExact</span><span>(CrystalCityCells)</span></span>
<span class="giallo-l"><span style="color: #F286C4;">end</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #F286C4;">local</span><span> PlaylistPriority</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> require</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">doc.playlistPriority</span><span style="color: #DEE492;">&#39;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@type</span><span style="color: #97E1F1;font-style: italic;"> S3maphorePlaylist[]</span></span>
<span class="giallo-l"><span style="color: #F286C4;">return</span><span> {</span></span>
<span class="giallo-l"><span>    {</span></span>
<span class="giallo-l"><span>        id</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">MOMW Patches - Secrets of the Crystal City</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>        priority</span><span style="color: #F286C4;"> =</span><span> PlaylistPriority.CellExact,</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>        tracks</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span style="color: #DEE492;">            &#39;</span><span style="color: #E7EE98;">music/aa22/tew_aa_3.mp3</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>        },</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>        isValidCallback</span><span style="color: #F286C4;"> =</span><span> crystalCityRule,</span></span>
<span class="giallo-l"><span>    },</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>The idea is to provide a bunch of built-in variables and functions to playlists so that it is no longer necessary for every playlist to <code>require</code> the same things every other one does. S3maphore's built-in event handling functions and tilesets are provided through this environment, as well as <code>openmw.interfaces</code>, and many builtin lua functions you otherwise would not have access to.</p>
<p>The environment is easily extensible through the core.lua which creates it, so please feel free to request new functions here.</p>
<p>Full playlist environment specification:</p>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> S3maphorePlaylistEnv</span></span>
<span class="giallo-l"><span style="color: #F286C4;">local</span><span> PlaylistEnvironment</span><span style="color: #F286C4;"> =</span><span> {</span></span>
<span class="giallo-l"><span>    playSpecialTrack</span><span style="color: #F286C4;"> =</span><span> MusicManager.playSpecialTrack,</span></span>
<span class="giallo-l"><span>    skipTrack</span><span style="color: #F286C4;"> =</span><span> MusicManager.skipTrack,</span></span>
<span class="giallo-l"><span>    setPlaylistActive</span><span style="color: #F286C4;"> =</span><span> MusicManager.setPlaylistActive,</span></span>
<span class="giallo-l"><span>    timeOfDay</span><span style="color: #F286C4;"> =</span><span> MusicManager.playlistTimeOfDay,</span></span>
<span class="giallo-l"><span>    INTERRUPT</span><span style="color: #F286C4;"> =</span><span> MusicManager.INTERRUPT,</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">    ---</span><span style="color: #F286C4;">@type</span><span style="color: #97E1F1;font-style: italic;"> PlaylistPriority</span></span>
<span class="giallo-l"><span>    PlaylistPriority</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> require</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">doc.playlistPriority</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    Tilesets</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> require</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">doc.tilesets</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    Playback</span><span style="color: #F286C4;"> =</span><span> Playback,</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">    ---</span><span style="color: #F286C4;">@type</span><span style="color: #97E1F1;font-style: italic;"> table &lt;string</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">any&gt;</span></span>
<span class="giallo-l"><span>    I</span><span style="color: #F286C4;"> =</span><span> I,</span></span>
<span class="giallo-l"><span>    require</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> require</span><span>,</span></span>
<span class="giallo-l"><span>    math</span><span style="color: #F286C4;"> =</span><span> math,</span></span>
<span class="giallo-l"><span>    string</span><span style="color: #F286C4;"> =</span><span> string,</span></span>
<span class="giallo-l"><span>    ipairs</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> ipairs</span><span>,</span></span>
<span class="giallo-l"><span>    pairs</span><span style="color: #F286C4;"> =</span><span style="color: #97E1F1;"> pairs</span><span>,</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">    --- Takes any number of paramaters and deep prints them, if debug logging is enabled</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">    ---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> ... any</span></span>
<span class="giallo-l"><span style="color: #62E884;">    print</span><span style="color: #F286C4;"> = function</span><span>(...)</span></span>
<span class="giallo-l"><span>        helpers.</span><span style="color: #62E884;">debugLog</span><span>(helpers.</span><span style="color: #62E884;">deepToString</span><span>({ </span><span style="color: #BF9EEE;">...</span><span> }, </span><span style="color: #BF9EEE;">3</span><span>))</span></span>
<span class="giallo-l"><span style="color: #F286C4;">    end</span><span>,</span></span>
<span class="giallo-l"><span>}</span></span></code></pre><h4 id="the-special-playlist">The Special Playlist</h4>
<p>The <code>Special</code> playlist is, well, a special case - it comes with no tracks, and is the ONLY playlist which is allowed to do so intentionally. Playing a special track using either the below events or interfaces will play the specified track, once, and then fall back to whatever playback behavior is contextually appropriate. This can be useful for playing things like boss music, or the levelup sting.</p>
<h4 id="playlist-localization">Playlist Localization</h4>
<p><em>All</em> S3maphore playlists natively support being localized, thanks to OpenMW's use of the l10n system. To provide localizations for a playlist, make a folder adjacent to your playlists folder, called <code>l10n</code>. Inside of that, make another folder called, <code>S3maphoreTracks${PLAYLIST_ID}</code>. For example, the builtin music playlists are in <code>S3maphoreTracksExplore</code> and <code>S3maphoreTracksBattle</code>. You'll see localized versions of track and playlist names onscreen as they change, if you have the <code>BannerEnabled</code> setting enabled.</p>
<h4 id="events">Events</h4>
<p>S3maphore includes a selection of <code>Player</code> events which indicate the changing of tracks and responds to some to modify its behavior.</p>
<ol>
<li>S3maphoreSkipTrack - <code>()</code> - skips the current track</li>
<li>S3maphoreToggleMusic - <code>({ state: boolean })</code> - set whether music plays or not. Will immediately stop playback when disabling.</li>
<li>S3maphoreSetPlaylistActive - <code>({ playlist: string, state: boolean })</code> - Enables or disables a playlist</li>
<li>S3maphoreSpecialTrack - <code>({ trackPath: string, reason: S3maphoreTrackChangeReason })</code> - plays one specific track from the <code>special</code> playlist which will not be interrupted, but may be overridden by other playlists in the <code>Special</code> priority class.</li>
<li>S3maphoreTrackChanged - <code>(S3maphoreStateChangeEventData)</code> - Emitted whenever the currently playing track changes, due to the previous one being skipped, or a new playlist starting, or a new track from the same playlist starting.</li>
<li>S3maphoreMusicStopped - <code>({ reason: S3maphoreTrackChangeReason })</code> - Emitted when music stops, due to being disabled, no playlist being valid for this frame, or just the player dying.</li>
</ol>
<h5 id="s3maphorestatechangeeventdata-specification">S3maphoreStateChangeEventData Specification</h5>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@class</span><span style="color: #97E1F1;font-style: italic;"> S3maphoreStateChangeEventData</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> playlistId</span><span style="color: #97E1F1;font-style: italic;"> string</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> trackName</span><span style="color: #97E1F1;font-style: italic;"> string VFS path of the track being played</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@field</span><span style="color: #7B7F8B;"> reason</span><span style="color: #97E1F1;font-style: italic;"> S3maphoreStateChangeReason</span></span></code></pre>
<p>See the interface documentation immediately below for the <code>S3maphoreTrackChangeReason</code> specification.</p>
<h5 id="interface">Interface</h5>
<p>If you need more direct control over what S3maphore is doing, it also offers an interface in <code>Player</code> scope, <code>I.S3maphore</code>. This is <em>especially</em> useful for debugging S3maphore via the console, as almost all of its important playlist-related functionality is exposed through this interface. The <code>S3maphoreSkipTrack</code>, <code>S3maphoreToggleMusic</code>, <code>S3maphoreSetPlaylistActive</code>, and <code>S3maphoreSpecialTrack</code> events are all shorthands for calling functions in this interface.</p>
<p>The various functions available are as follows:</p>
<pre class="giallo" style="color: #F6F6F4; background-color: #282A36;"><code data-lang="lua"><span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> trackPath</span><span style="color: #97E1F1;font-style: italic;"> string VFS path of the track to play</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> reason</span><span style="color: #97E1F1;font-style: italic;"> S3maphoreStateChangeReason</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> S3maphore</span><span>.</span><span style="color: #62E884;">playSpecialTrack</span><span>(</span><span style="color: #FFB86C;font-style: italic;">trackPath</span><span>,</span><span style="color: #FFB86C;font-style: italic;"> reason</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns a string listing all the currently registered playlists, mapped to their (descending) priority.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Mostly intended to be used via the `luap` console.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> string</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> S3maphore</span><span>.</span><span style="color: #62E884;">listPlaylistsByPriority</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Disable or enable music playback (via setting, which persists through boot cycles)</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> enabled</span><span style="color: #97E1F1;font-style: italic;"> boolean</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">overrideMusicEnabled</span><span>(</span><span style="color: #FFB86C;font-style: italic;">enabled</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Whether or not S3maphore&#39;s music playback is enabled</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">getEnabled</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns a read-only array of all recognized playlist files (files with the .lua extension under the VFS directory, Playlists/ )</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> userdata playlistFiles</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">listPlaylistFiles</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns a read-only list of read-only playlist structs for introspection. To modify playlists in any way, use other functions.</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">getRegisteredPlaylists</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns a read-only copy of the current playlist, or nil</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> userdata</span><span style="color: #F286C4;">?</span><span style="color: #97E1F1;font-style: italic;"> readOnlyPlaylist</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">getCurrentPlaylist</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns l10n-localized playlist and track names for the current playlist. If a localization for the track does not exist, return nil</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> string</span><span style="color: #F286C4;">?</span><span style="color: #97E1F1;font-style: italic;"> playlistName</span><span style="color: #F286C4;">, </span><span style="color: #97E1F1;font-style: italic;">string</span><span style="color: #F286C4;">?</span><span style="color: #97E1F1;font-style: italic;"> trackName</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">getCurrentTrackInfo</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Returns the path of the currently playing track</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@return</span><span style="color: #97E1F1;font-style: italic;"> string</span><span style="color: #F286C4;">?</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">getCurrentTrack</span><span>()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- initialize any missing playlist fields and assign track order for the playlist, and global registration order.</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@param</span><span style="color: #7B7F8B;"> playlist</span><span style="color: #97E1F1;font-style: italic;"> S3maphorePlaylist</span></span>
<span class="giallo-l"><span style="color: #F286C4;">function</span><span style="color: #62E884;"> MusicManager</span><span>.</span><span style="color: #62E884;">registerPlaylist</span><span>(</span><span style="color: #FFB86C;font-style: italic;">playlist</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Used as the `reason` argument in S3maphore Events</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;">---</span><span style="color: #F286C4;">@enum</span><span> S3maphoreStateChangeReason</span></span>
<span class="giallo-l"><span>S3maphore.STATE</span><span style="color: #F286C4;"> =</span><span> util.</span><span style="color: #62E884;">makeReadOnly</span><span> {</span></span>
<span class="giallo-l"><span>    Died</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">DIED</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    Disabled</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">DSBL</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    NoPlaylist</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">NPLS</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    SpecialTrackPlaying</span><span style="color: #F286C4;"> =</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">SPTR</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>},</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7B7F8B;">--- Meant to be used in conjunction with the output of MusicManager.playlistTimeOfDay OR PlaylistState.playlistTimeOfDay</span></span>
<span class="giallo-l"><span style="color: #7B7F8B;"> ---</span><span style="color: #F286C4;">@enum</span><span> TimeMap</span></span>
<span class="giallo-l"><span>S3maphore.TIME_MAP</span><span style="color: #F286C4;"> =</span><span> util.</span><span style="color: #62E884;">makeReadOnly</span><span> {</span></span>
<span class="giallo-l"><span>    [</span><span style="color: #BF9EEE;">0</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">night</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    [</span><span style="color: #BF9EEE;">1</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">morning</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    [</span><span style="color: #BF9EEE;">2</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">afternoon</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    [</span><span style="color: #BF9EEE;">3</span><span>] </span><span style="color: #F286C4;">=</span><span style="color: #DEE492;"> &#39;</span><span style="color: #E7EE98;">evening</span><span style="color: #DEE492;">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>}</span></span></code></pre><h4 id="settings">Settings</h4>
<p>S3maphore's main settings group is a <code>Player</code> scoped storage section called <code>SettingsS3Music</code>. It contains the following keys and values:</p>
<p>1.<code>Enable Debug Messages</code> - <code>Checkbox</code> - Whether or not to use verbose logging. Press F10 in-game or veiew openmw.log for more details. Every line with S3maphore log outputs will start with <code>[ S3MAPHORE ]:</code></p>
<ol>
<li>
<p><code>Enable Music</code> - <code>Checkbox</code> - Whether or not S3maphore will play music <em>at all</em>, for the purposes of temporarily stopping playback to be managed by something else</p>
</li>
<li>
<p><code>Show Track Info</code> - <code>Checkbox</code> - Whether or not the current playlist and track names will be shown when S3maphore changes songs.</p>
</li>
<li>
<p><code>Enable Combat Music</code> - <code>Checkbox</code> - If this is disabled, combat music will never play. Added by request.</p>
</li>
<li>
<p><code>Finish Previous Track</code> - <code>Checkbox</code> - Enabled by default, this setting prevents playlist changes with the same interrupt mode from interrupting music playback.</p>
</li>
<li>
<p><code>Allow Friendly Interior Playlist Override</code> - <code>Checkbox</code> - disabled by default, this setting allows overriding the finish previous track setting, when entering a friendly interior, such as a tavern.</p>
</li>
<li>
<p><code>Allow Dungeon Playlist Override</code> - <code>Checkbox</code>  - enabled by default, overrides the finish previous track setting when entering a dungeon.</p>
</li>
<li>
<p><code>Allow Overworld Playlist Override</code> - <code>Checkbox</code> - disabled by default, allows playlist changes while traversing exteriors to override one another. May be removed in a later version as this was the main reason <code>Finish Previous Track</code> was implemented in the first place.</p>
</li>
<li>
<p><code>Default Fade Duration</code> - <code>Number</code> - Global fadeOut duration used between tracks if a playlist doesn't specify its own.</p>
</li>
<li>
<p><code>Enable Silence Tracks</code> - <code>Checkbox</code> - Enabled by default, allows S3maphore to stop music playback for a specified amount of time between track changes in the same playlist.</p>
</li>
<li>
<p><code>Global Silence Chance</code> - <code>Number</code> - Defaults to <code>0.15</code>, this is the global chance for silence tracks to play. If a playlist specifies this value itself, that is used instead.</p>
</li>
<li>
<p><code>Explore Silence Min Duration</code> - <code>Number</code> - Minimum duration for playback to stop between tracks, during Explore playlists. Randomly selected between this and the maximum value.</p>
</li>
<li>
<p><code>Explore Silence Max Duration</code> - <code>Number</code> - Maximum duration for playback to stop between tracks, during Explore playlists. Randomly selected between this and the minimum value.</p>
</li>
<li>
<p><code>Battle Silence Min Duration</code> - <code>Number</code> - Minimum duration for playback to stop between tracks, during Battle playlists. Randomly selected between this and the maximum value.</p>
</li>
<li>
<p><code>Battle Silence Max Duration</code> - <code>Number</code> - Maximum duration for playback to stop between tracks, during Battle playlists. Randomly selected between this and the minimum value.</p>
</li>
</ol>
<p>There also is another <code>Player</code> scoped storage section of note - <code>S3maphoreActivePlaylistSettings</code>. All playlists registered by S3maphore can have their active states set by other scripts by setting the key <code>${PLAYLISTNAME}Active</code> to <code>true</code> or <code>false</code>. S3maphore will then automatically respond to this change and disable/enable the playlist accordingly. Every playlist can also be permanently toggled on or off in the settings menu manually.</p>
<br><div id="credits-container"><h2 id="credits">Credits</h2><p>All code in this repository was generated by Dave Corley under the GPL3 License.</p><p>Please enjoy my content, hack away as you please, and respect the freedoms of your fellow creators in the meantime.</p><p>All code was written by Dave Corley under the GPL3 license. Please enjoy my mod, hack away as you please, and respect the freedoms of your fellow modders and players in the meantime.  </p><p>I pour my entire heart, soul, and talent into this community. If you appreciate my work, please, [please consider supporting me on Ko-Fi.](https:&#x2F;&#x2F;ko-fi.com&#x2F;magicaldave)  </p><p>I would do this full-time if I could only afford to.  </p><p>Thanks for listening &lt;3</p></div>

        </div>

        
    </div>

    </div>

    
<footer class="footer"><script src="https://giscus.app/client.js"
        data-repo="DreamWeave-MP/S3ctors-S3cret-St4sh"
        data-repo-id="R_kgDOQtd5bg"
        data-category="General"
        data-category-id="DIC_kwDOQtd5bs4C0JZa"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="dark_dimmed"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
    </script><div class="footer__inner">
            <div class="copyright">
                <div class="button-stack copyright-theme" style="align-items:center;">
                    <span> 
    2026
 :: Brought to you by <a href="https://github.com/DreamWeave-MP">DreamWeave</a></span>
                    <a class="dw-download-button" style="opacity:1.0;" href="https://github.com/DreamWeave-MP/DreamWeave-Mod-Template/">
                        <b>Use this Mod Template</b>
                    </a>
                    <a href="http://www.catb.org/hacker-emblem" title="Hacker Emblem" target="_blank">
                        <img class="hacker-emblem" src="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/img/glider.svg" alt="Hacker Emblem">
                    </a>
                </div>
            </div>
        </div><script data-goatcounter="https://dreamweave-mp.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></footer>


</div><meta name="search-index-data" url="https:&#x2F;&#x2F;DreamWeave-MP.github.io&#x2F;S3ctors-S3cret-St4sh" build_date="2026-03-01T22:17:47.923226258+00:00">
    <script type="text/javascript" src="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/js/fuse.min.js"></script>
    <script type="text/javascript" src="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/js/fuseSearch.js"></script><script src="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/js/installModule.js" defer></script>
<script src="https://DreamWeave-MP.github.io/S3ctors-S3cret-St4sh/js/backToToc.js" defer></script>
</body>

</html>
